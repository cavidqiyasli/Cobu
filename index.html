<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>2D Quş Baxışı Oyun</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { margin: 0; background: #111; overflow: hidden; }
    canvas { display: block; margin: auto; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>
<script>
const config = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  backgroundColor: '#222',
  physics: {
    default: 'arcade',
    arcade: {
      debug: false
    }
  },
  scene: { preload, create, update }
};

let player;
let bullets;
let keys;
let lastFired = 0;

const game = new Phaser.Game(config);

function preload() {}

function create() {
  const scene = this;

  // Oyuncu (yaşıl dairə)
  player = scene.add.circle(400, 300, 20, 0x00ff00);
  scene.physics.add.existing(player);
  player.body.setCollideWorldBounds(true);

  // Güllə qrupu
  bullets = scene.physics.add.group();

  // Klaviatura idarəsi
  keys = scene.input.keyboard.addKeys({
    up: 'W', down: 'S', left: 'A', right: 'D'
  });

  // Maus hərəkəti - baxış istiqaməti
  scene.input.on('pointermove', pointer => {
    const angle = Phaser.Math.Angle.Between(player.x, player.y, pointer.x, pointer.y);
    player.rotation = angle;
  });

  // Sol kliklə atəş
  scene.input.on('pointerdown', pointer => {
    shoot(scene, pointer);
  });
}

function update(time) {
  const speed = 250;
  player.body.setVelocity(0);

  if (keys.left.isDown) player.body.setVelocityX(-speed);
  if (keys.right.isDown) player.body.setVelocityX(speed);
  if (keys.up.isDown) player.body.setVelocityY(-speed);
  if (keys.down.isDown) player.body.setVelocityY(speed);
}

// Atəş funksiyası
function shoot(scene, pointer) {
  const bullet = scene.add.circle(player.x, player.y, 5, 0xff0000);
  scene.physics.add.existing(bullet);

  const angle = Phaser.Math.Angle.Between(player.x, player.y, pointer.x, pointer.y);
  const speed = 600;
  const velocity = scene.physics.velocityFromRotation(angle, speed);

  bullet.body.setVelocity(velocity.x, velocity.y);

  // Güllə 1.5 saniyəyə yox olsun
  scene.time.delayedCall(1500, () => bullet.destroy());
}
</script>
</body>
</html>
